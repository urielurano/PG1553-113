
{
 gROOT->Reset();

 c1=new TCanvas ("c1", "",20,1,640,480);
 TMultiGraph *mg = new TMultiGraph();
 mg->SetTitle(";E(eV); E^{2}dN/dE (MeV cm^{-2} s^{-1})");
 c1->SetFillColor(10);
 c1->GetFrame()->SetFillColor(25);
 c1->GetFrame()->SetBorderSize(20);
 

 Int_t n=64;//unkonwn
 Int_t i;
 Float_t w[n]={
 10**(14.525367757-14.25),
 10**(14.567397178-14.25),
 10**(8.6239505081-14.25),
 10**(9.2178524083-14.25),
 10**(9.2991604065-14.25),
 10**(9.9474149359-14.25),
 10**(9.9650905877-14.25),
 10**(14.560192134-14.25),
 10**(14.771239867-14.25),
 10**(17.988592014-14.25),
 10**(18.936955869-14.25),
 10**(17.135094566-14.25),
 10**(17.225457820-14.25),
 10**(17.345842089-14.25),
 10**(17.436205343-14.25),
 10**(17.526268387-14.25),
 10**(17.646652656-14.25),
 10**(17.736715701-14.25),
 10**(17.796457520-14.25),
 10**(17.886520564-14.25),
 10**(17.946262383-14.25),
 10**(18.006004202-14.25),
 10**(18.095767036-14.25),
 10**(18.185529870-14.25),
 10**(18.275292704-14.25),
 10**(18.365055538-14.25),
 10**(18.424196937-14.25),
 10**(18.483038126-14.25),
 10**(18.541879315-14.25),
 10**(18.601020714-14.25),
 10**(18.629840888-14.25),
 10**(18.688982287-14.25),
 10**(18.718102671-14.25),
 10**(18.777544281-14.25),
 10**(18.936955869-14.25),
 10**(14.686280396-14.25),
 10**(14.777844491-14.25),
 10**(14.870309216-14.25),
 10**(14.990693485-14.25),
 10**(15.082557790-14.25),
 10**(17.133893725-14.25),
 10**(17.194536175-14.25),
 10**(17.254578204-14.25),
 10**(17.314620234-14.25),
 10**(17.374662263-14.25),
 10**(17.434704293-14.25),
 10**(17.525067547-14.25),
 10**(17.585409786-14.25),
 10**(17.615430801-14.25),
 10**(17.676073251-14.25),
 10**(17.766736715-14.25),
 10**(17.826778745-14.25),
 10**(18.006904833-14.25),
 10**(18.187030921-14.25),
 10**(17.395977184-14.25),
 10**(17.243470429-14.25),
 10**(17.486040228-14.25),
 10**(17.302611828-14.25),
 10**(17.424196937-14.25),
 10**(17.453317322-14.25),
 10**(17.604022816-14.25),
 10**(17.693485439-14.25),
 10**(17.813869708-14.25),
 10**(18.052236565-14.25)
 };//x

 Float_t v[n]={
 10**(-10.361152807),
 10**(-9.9741819273),
 10**(-14.798585947),
 10**(-14.375784357),
 10**(-14.279805567),
 10**(-13.625452938),
 10**(-13.517631462),
 10**(-10.211948363),
 10**(-10.247373161),
 10**(-10.074752326),
 10**(-10.778745121),
 10**(-10.240168117),
 10**(-10.258180726),
 10**(-10.285499849),
 10**(-10.303512458),
 10**(-10.331432002),
 10**(-10.358751125),
 10**(-10.386670669),
 10**(-10.415190633),
 10**(-10.443110177),
 10**(-10.471630141),
 10**(-10.500150105),
 10**(-10.537976583),
 10**(-10.575803062),
 10**(-10.613629540),
 10**(-10.651456019),
 10**(-10.699789852),
 10**(-10.758030621),
 10**(-10.81627139 ),
 10**(-10.864605223),
 10**(-10.913539477),
 10**(-10.961873311),
 10**(-11.000900630),
 10**(-11.039327529),
 10**(-10.778745121),
 10**(-10.051035725),
 10**(-10.029420594),
 10**(-9.9780846592),
 10**(-10.005403782),
 10**(-9.9738817172),
 10**(-9.2797958571),
 10**(-9.2785950165),
 10**(-9.2972080456),
 10**(-9.3158210747),
 10**(-9.3344341038),
 10**(-9.3530471329),
 10**(-9.3710597418),
 10**(-9.3797658360),
 10**(-9.3890723506),
 10**(-9.3878715100),
 10**(-9.3959771840),
 10**(-9.4145902131),
 10**(-9.4704293005),
 10**(-9.5262683878),
 10**(-9.6310417292),
 10**(-9.6637646352),
 10**(-9.6589612728),
 10**(-9.7120984689),
 10**(-9.6997898529),
 10**(-9.7388171720),
 10**(-9.7655358751),
 10**(-9.8132692885),
 10**(-9.8405884118),
 10**(-9.9744821375)
 };//y,

 Float_t ewl[n]={0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0};

 Float_t evl[n]={0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0};

 Float_t ewh[n]={0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0};

 Float_t evh[n]={0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0};
 gr=new TGraphAsymmErrors(n,w,v,ewl,ewh,evl,evh);
 gr->SetMarkerColor();
 gr->SetMarkerStyle(8);
 gr->SetMarkerSize(0.7);
 gr->SetLineColor(1);
 gPad->SetLogy();
 gPad->SetLogx();
 
 gr->SetLineStyle(1);  
 gPad->SetLogy();  
 gPad->SetLogx();


 




 
 Int_t n20=2;//end
 Int_t i;
 Float_t w20[n20]={9.484e13,1.796e13};
 Float_t v20[n20]={1.435e-9,1.996e-9};
 Float_t ewl20[n20]={0,0};
 Float_t evl20[n20]={0,0};
 Float_t ewh20[n20]={0,0};
 Float_t evh20[n20]={0,0};
 gr20=new TGraphAsymmErrors(n20,w20,v20,ewl20,ewh20,evl20,evh20);
 gr20->SetMarkerColor();
 gr20->SetMarkerStyle(8);
 gr20->SetMarkerSize(0.0001);  
 gr20->SetLineColor(3);
 gPad->SetLogy();  
 gPad->SetLogx();
 gr20->SetFillColor(2); 

 Int_t n21=2;//beginning
 Int_t i;
 Float_t w21[n21]={2.484e-9,5.796e-9};
 Float_t v21[n21]={1.435e-9,1.996e-9};
 Float_t ewl21[n21]={0,0};
 Float_t evl21[n21]={0,0};
 Float_t ewh21[n21]={0,0};
 Float_t evh21[n21]={0,0};
 gr21=new TGraphAsymmErrors(n21,w21,v21,ewl21,ewh21,evl21,evh21);
 gr21->SetMarkerColor();
 gr21->SetMarkerStyle(8);
 gr21->SetMarkerSize(0.0001);  
 gr21->SetLineColor(3);
 gPad->SetLogy();  
 gPad->SetLogx();
 gr21->SetFillColor(2); 






  mg->Add(gr);
 
  mg->Add(gr20);
 mg->Add(gr21);
 
 mg->Draw("apz");




//############################Fit formulas###############
//################
//##############################################################
//
fun4 = new TF1("fun4","[0]*((x/[2])^(4/3)*(x>1e-7)*(x<[2])+((x/[2])**((3-[1])/2)*(x>=[2])*(x<[3])) + (([3]/[2])**((3-[1])/2))*((x/[3])**((2-[1])/2))*(x>=[3])*(x<5e5))",  1e-7,5e5); //pgamma interaction
// Se fija el valor inicial de las energías de normalización:
fun4->SetParameter(1,2.5);
fun4->SetParLimits(1,2,3);
fun4->SetParameter(2,1e-3);
fun4->SetParLimits(2,1e-5,1e-1);
fun4->SetParameter(3,1e1);
fun4->SetParLimits(3,1e-1,1e5);
fun4->SetParameter(4,100);
// fun3 = new TF1("fun3","[0]*(x/1e12)^(2-[1])",1e+11,1e+13); //pp interaction
 //
////#################fit commands############
////####################################
////###############
////
////
////((1e-1/1)^(-0.5)*(x/1)^(4/3)*(1e-4/1)**((3-[1])/2)*(x>1e-6)*(x<1e-4))
//
 fun4->SetLineWidth(2);
  gr->Fit("fun4","APL+"); 
 //// gr4->Fit("fun3","APL+"); 
 }


